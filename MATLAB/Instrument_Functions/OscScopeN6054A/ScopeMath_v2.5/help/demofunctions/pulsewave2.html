<html>
<head>
<title>pulsewave2</title>
<meta name="description" content="">
<meta name="keywords" content="INVERTWAVE  SQUAREWAVE  PULSEWAVE  ZEROCROSSING  
 ">
<!--Comment-->
</head>
<font color=blue>function</font> varargout =  PULSEWAVE2( Data, Time )<br>
<font color=green>% &nbsp;&nbsp;PULSEWAVE2&nbsp;Create&nbsp;a&nbsp;pulse&nbsp;at&nbsp;zero&nbsp;crossings</font><br>
<font color=green>% &nbsp;&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;Usage:</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;[X,Y]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PULSEWAVE2(DATA,TIME);</font><br>
<font color=green>% &nbsp;&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATLAB&nbsp;Code&nbsp;that&nbsp;is&nbsp;executed:&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sig&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(Data&gt;guardband)&nbsp;-&nbsp;(Data&lt;-guardband);</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;find(sig);&nbsp;&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;find(diff(sig(idx)));&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;idx(w);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;zeros(size(Data));</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fData(idx1)&nbsp;=&nbsp;1;</font><br>
<font color=green>% &nbsp;&nbsp;</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;See&nbsp;also</font><br>
<font color=green>% &nbsp;&nbsp;&nbsp;INVERTWAVE,&nbsp;SQUAREWAVE,&nbsp;PULSEWAVE,&nbsp;ZEROCROSSING&nbsp;&nbsp;</font><br>
<br>
<code></code><br>
<code><font color=blue>if</font> nargout ==3</code><br>
<code>&nbsp;&nbsp;&nbsp;  varargout{1} = <font color=red>'Time'</font >;</code><br>
<code>&nbsp;&nbsp;&nbsp;  varargout{2} = <font color=red>'Units'</font >;</code><br>
<code>&nbsp;&nbsp;&nbsp;  varargout{3} = <font color=red>'Pulses at Zero Crossings'</font >;</code><br>
<code>&nbsp;&nbsp;&nbsp;  <font color=blue>return</font>;</code><br>
<code><font color=blue>end</font>;	</code><br>
<code></code><br>
<code><font color=blue>if</font> nargin==0</code><br>
<code>&nbsp;&nbsp;&nbsp;  help(mfilename)</code><br>
<code>&nbsp;&nbsp;&nbsp;  <font color=blue>return</font>;</code><br>
<code><font color=blue>end</font>;</code><br>
<code></code><br>
<code>Data = Data-mean(Data);</code><br>
<code></code><br>
<code><font color=green>% I use a guardband in case of noise.</font></code><br>
<code>guardband = max(Data)*0.01;</code><br>
<code></code><br>
<code>sig = (Data&gt;guardband) - (Data&lt;-guardband);</code><br>
<code></code><br>
<code><font color=green>% Find the index of all the points outside of the guardband</font></code><br>
<code>idx  = find(sig);  </code><br>
<code></code><br>
<code><font color=green>% Generate indexes of when we transition from one state to the other.</font></code><br>
<code><font color=green>%   Remember a derivative (diff) is zero for constant values and a number if there is a change.</font></code><br>
<code>&nbsp;w = find(diff(sig(idx))); </code><br>
<code>idx1 = idx(w);              % Valid Point before Crossing state</code><br>
<code></code><br>
<code><font color=green>% Generate the output signal with zeros except at just before crossing</font></code><br>
<code>fData = zeros(size(Data));</code><br>
<code>fData(idx1) = 1;</code><br>
<code></code><br>
<code>varargout{1} = Time;</code><br>
<code>varargout{2} = fData;</code><br>
<br><a href="intro.html">Return to Content</a></html>
