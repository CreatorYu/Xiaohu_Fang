%% Clear repetitive kernels
function [ h , Avalue ] = ClearRepetitiveKernels( A , Avalue )
    [ D , order ] = size (A) ;    
    h = [] ;
    switch order
        %% --- 1st order
        case 1
            h1 = A ;
            h1( 1 , : ) = [ ] ;
            Avalue( 1 , : ) = [ ] ;
            h = h1 ;        %% --- 3rd order
        %% --- 2nd order               
        case 2
            A(:,2)    = A(:,2) * 1i   ;   
            for k = 1 : D
                B = sort( A , 2 ) ;
                a =    B( k , : ) ;
                % find lines that are the same
                [ x , y ] = find( ( B( : , 1 ) == a( : , 1 ) ) & ( B( : , 2 ) == a( : , 2 ) ) ) ;
                x( 1     ) = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h2 = A ;
            h2( 1 , : ) = [ ] ;
            Avalue( 1 , : ) = [ ] ;
            h2( : ,  2 ) = h2( : , 2 ) * ( -1i ) ;
            h = h2 ;
        %% --- 3rd order               
        case 3
            A(:,3)    = A(:,3) * 1i   ;   
            for k = 1 : D
                B = sort( A , 2 ) ;
                a =    B( k , : ) ;
                % find lines that are the same
                [ x , y ] = find( ( B( : , 1 ) == a( : , 1 ) ) & ( B( : , 2 ) == a( : , 2 ) ) & ( B( : , 3 ) == a( : , 3 ) ) ) ;
                x( 1     ) = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h3 = A ;
            h3( 1 , : ) = [ ] ;
            Avalue( 1 , : ) = [ ] ;
            h3( : ,  3 ) = h3( : , 3 ) * ( -1i ) ;
            h = h3 ;
        %% --- 4th order               
        case 4
            A(:,3)    = A(:,3) * 1i   ;   
            A(:,4)    = A(:,4) * 1i   ;   
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : ); 
                [ x , y ] = find( ...
                                  ( B( : , 1 ) == a( : , 1 ) ) ...
                                & ( B( : , 2 ) == a( : , 2 ) ) ...
                                & ( B( : , 3 ) == a( : , 3 ) ) ...
                                & ( B( : , 4 ) == a( : , 4 ) ) );
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h4 = A ;
            h4( 1 , : ) = [ ] ;  
            Avalue( 1 , : ) = [ ] ;
            h4( : , 3 ) = h4( : , 3 ) * ( -1i ) ; 
            h4( : , 4 ) = h4( : , 4 ) * ( -1i ) ;            
            h = h4 ;
        %% --- 5th order
        case 5
            A(:,4)    = A(:,4) * 1i   ;   
            A(:,5)    = A(:,5) * 1i   ;   
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : ); 
                [ x , y ] = find( ...
                                  ( B( : , 1 ) == a( : , 1 ) ) ...
                                & ( B( : , 2 ) == a( : , 2 ) ) ...
                                & ( B( : , 3 ) == a( : , 3 ) ) ...
                                & ( B( : , 4 ) == a( : , 4 ) ) ...
                                & ( B( : , 5 ) == a( : , 5 ) ) );
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h5 = A ;
            h5( 1 , : ) = [ ] ;  
            Avalue( 1 , : ) = [ ] ;
            h5( : , 4 ) = h5( : , 4 ) * ( -1i ) ; 
            h5( : , 5 ) = h5( : , 5 ) * ( -1i ) ;            
            h = h5 ;
        %% --- 6th order            
        case 6
            A(:,4) = A(:,4) * 1i ;
            A(:,5) = A(:,5) * 1i ;
            A(:,6) = A(:,6) * 1i ;
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : ) ; 
                [ x , y ] = find( ...
                                  ( B( : , 1 ) == a( : , 1 ) ) ...
                                & ( B( : , 2 ) == a( : , 2 ) ) ...
                                & ( B( : , 3 ) == a( : , 3 ) ) ...
                                & ( B( : , 4 ) == a( : , 4 ) ) ...
                                & ( B( : , 5 ) == a( : , 5 ) ) ...
                                & ( B( : , 6 ) == a( : , 6 ) ) ) ;
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h6          = A                 ;
            h6( 1 , : ) = [ ]               ;
            Avalue( 1 , : ) = [ ] ;
            h6( : , 4 ) = h6( : , 4 ) * -1i ;
            h6( : , 5 ) = h6( : , 5 ) * -1i ;
            h6( : , 6 ) = h6( : , 6 ) * -1i ;
            h           = h6                ;
        %% --- 7th order            
        case 7
            A(:,5) = A(:,5) * 1i ;
            A(:,6) = A(:,6) * 1i ;
            A(:,7) = A(:,7) * 1i ;
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : ) ; 
                [ x , y ] = find( ...
                                  ( B( : , 1 ) == a( : , 1 ) ) ...
                                & ( B( : , 2 ) == a( : , 2 ) ) ...
                                & ( B( : , 3 ) == a( : , 3 ) ) ...
                                & ( B( : , 4 ) == a( : , 4 ) ) ...
                                & ( B( : , 5 ) == a( : , 5 ) ) ...
                                & ( B( : , 6 ) == a( : , 6 ) ) ...
                                & ( B( : , 7 ) == a( : , 7 ) ) ) ;
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h7          = A                 ;
            h7( 1 , : ) = [ ]               ;
            Avalue( 1 , : ) = [ ] ;
            h7( : , 5 ) = h7( : , 5 ) * -1i ;
            h7( : , 6 ) = h7( : , 6 ) * -1i ;
            h7( : , 7 ) = h7( : , 7 ) * -1i ;
            h           = h7                ;
        %% --- 8th order            
        case 8
            A(:,5) = A(:,5) * 1i ;
            A(:,6) = A(:,6) * 1i ;
            A(:,7) = A(:,7) * 1i ;
            A(:,8) = A(:,8) * 1i ;
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : ) ;
                [ x , y ] = find( ...
                                  ( B( : , 1 ) == a( : , 1 ) ) ...
                                & ( B( : , 2 ) == a( : , 2 ) ) ...
                                & ( B( : , 3 ) == a( : , 3 ) ) ...
                                & ( B( : , 4 ) == a( : , 4 ) ) ...
                                & ( B( : , 5 ) == a( : , 5 ) ) ...
                                & ( B( : , 6 ) == a( : , 6 ) ) ...
                                & ( B( : , 7 ) == a( : , 7 ) ) ...
                                & ( B( : , 8 ) == a( : , 8 ) ) ) ;
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h8          = A                 ;
            h8( 1 , : ) = [ ]               ;
            Avalue( 1 , : ) = [ ] ;
            h8( : , 5 ) = h8( : , 5 ) * -1i ;
            h8( : , 6 ) = h8( : , 6 ) * -1i ;
            h8( : , 7 ) = h8( : , 7 ) * -1i ;
            h8( : , 8 ) = h8( : , 8 ) * -1i ;
            h           = h8                ;
        %% --- 9th order            
        case 9
            A(:,6) = A(:,5) * 1i ;
            A(:,7) = A(:,7) * 1i ;
            A(:,8) = A(:,8) * 1i ;
            A(:,9) = A(:,9) * 1i ;
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : ) ;
                [ x , y ] = find( ...
                                  ( B( : , 1 ) == a( : , 1 ) ) ...
                                & ( B( : , 2 ) == a( : , 2 ) ) ...
                                & ( B( : , 3 ) == a( : , 3 ) ) ...
                                & ( B( : , 4 ) == a( : , 4 ) ) ...
                                & ( B( : , 5 ) == a( : , 5 ) ) ...
                                & ( B( : , 6 ) == a( : , 6 ) ) ...
                                & ( B( : , 7 ) == a( : , 7 ) ) ...
                                & ( B( : , 8 ) == a( : , 8 ) ) ...
                                & ( B( : , 9 ) == a( : , 9 ) ) ) ;
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h9          = A                 ;
            h9( 1 , : ) = [ ]               ;
            Avalue( 1 , : ) = [ ] ;
            h9( : , 6 ) = h9( : , 6 ) * -1i ;
            h9( : , 7 ) = h9( : , 7 ) * -1i ;
            h9( : , 8 ) = h9( : , 8 ) * -1i ;
            h9( : , 9 ) = h9( : , 9 ) * -1i ;
            h           = h9                ;
        %% --- 10th order
        case 10
            A(:,6) = A(:,6) * 1i ;
            A(:,7) = A(:,7) * 1i ;
            A(:,8) = A(:,8) * 1i ;
            A(:,9) = A(:,9) * 1i ;
            A(:,10) = A(:,10) * 1i ;
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : )    ;
                [ x , y ] = find( ...
                                  ( B( : , 1  ) == a( : , 1  ) ) ...
                                & ( B( : , 2  ) == a( : , 2  ) ) ...
                                & ( B( : , 3  ) == a( : , 3  ) ) ...
                                & ( B( : , 4  ) == a( : , 4  ) ) ...
                                & ( B( : , 5  ) == a( : , 5  ) ) ...
                                & ( B( : , 6  ) == a( : , 6  ) ) ...
                                & ( B( : , 7  ) == a( : , 7  ) ) ...
                                & ( B( : , 8  ) == a( : , 8  ) ) ...
                                & ( B( : , 9  ) == a( : , 9  ) ) ...
                                & ( B( : , 10 ) == a( : , 10 ) ) ) ;
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h10           = A                   ;
            h10( 1 , :  ) = [ ]                 ;   
            Avalue( 1 , : ) = [ ] ;
            h10( : , 6  ) = h10( : , 6  ) * -1i ;
            h10( : , 7  ) = h10( : , 7  ) * -1i ;
            h10( : , 8  ) = h10( : , 8  ) * -1i ;
            h10( : , 9  ) = h10( : , 9  ) * -1i ;
            h10( : , 10 ) = h10( : , 10 ) * -1i ;
            h             = h10                 ; 
        %% --- 11th order
        case 11
            A(:,7) = A(:,7) * 1i ;
            A(:,8) = A(:,8) * 1i ;
            A(:,9) = A(:,9) * 1i ;
            A(:,10) = A(:,10) * 1i ;
            A(:,11) = A(:,11) * 1i ;
            for k = 1 : D
                B = sort( A , 2 ) ;
                a = B( k , : )    ;
                [ x , y ] = find( ...
                                  ( B( : , 1  ) == a( : , 1  ) ) ...
                                & ( B( : , 2  ) == a( : , 2  ) ) ...
                                & ( B( : , 3  ) == a( : , 3  ) ) ...
                                & ( B( : , 4  ) == a( : , 4  ) ) ...
                                & ( B( : , 5  ) == a( : , 5  ) ) ...
                                & ( B( : , 6  ) == a( : , 6  ) ) ...
                                & ( B( : , 7  ) == a( : , 7  ) ) ...
                                & ( B( : , 8  ) == a( : , 8  ) ) ...
                                & ( B( : , 9  ) == a( : , 9  ) ) ...
                                & ( B( : , 10 ) == a( : , 10 ) ) ...
                                & ( B( : , 11 ) == a( : , 11 ) ) ) ;
                x( 1 )     = [ ] ;
                A( x , : ) = [ ] ;
                Avalue( x , : ) = [ ] ;
                if k == length( A )
                    break
                end
            end
            h11           = A                   ;
            h11( 1 , :  ) = [ ]                 ;   
            Avalue( 1 , : ) = [ ] ;
            h11( : , 7  ) = h11( : , 7  ) * -1i ;
            h11( : , 8  ) = h11( : , 8  ) * -1i ;
            h11( : , 9  ) = h11( : , 9  ) * -1i ;
            h11( : , 10 ) = h11( : , 10 ) * -1i ;
            h11( : , 11 ) = h11( : , 11 ) * -1i ;
            h             = h11                 ; 
    end  